<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Xổ Số - Phiên Bản RGB</title>
    <link rel="icon" href="lottery.png" type="image/png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        :root {
            --primary-color: #ff0055;
            --secondary-color: #00ff88;
            --accent-color: #0088ff;
            --background: #1a1a1a;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* RGB Background Animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(255, 0, 85, 0.1), 
                rgba(0, 255, 136, 0.1), 
                rgba(0, 136, 255, 0.1));
            animation: rgbFlow 15s linear infinite;
            z-index: -1;
        }

        @keyframes rgbFlow {
            0% {
                filter: hue-rotate(0deg);
            }
            100% {
                filter: hue-rotate(360deg);
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 2.5em;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px var(--primary-color),
                         0 0 20px var(--primary-color),
                         0 0 30px var(--primary-color);
        }

        .input-section {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .select-group {
            margin-bottom: 20px;
        }

        .select-group label {
            display: block;
            font-size: 1.1em;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        select {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(255, 0, 85, 0.2);
        }

        .btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 85, 0.3);
        }

        .result-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .number-set {
            margin-bottom: 25px;
        }

        .number-set h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.3em;
            text-shadow: 0 0 5px var(--accent-color);
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .number-cell {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .hot-number {
            background: linear-gradient(45deg, #ff0055, #ff0088);
            color: white;
        }

        .cold-number {
            background: linear-gradient(45deg, #0088ff, #00ffcc);
            color: white;
        }

        .pattern-number {
            background: linear-gradient(45deg, #00ff88, #88ff00);
            color: white;
        }

        .copy-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .copy-btn:hover {
            background: #0066cc;
            transform: translateY(-2px);
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading-dots {
            display: inline-block;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80% { content: '....'; }
            100% { content: '.....'; }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>AI Xổ Số Miền Bắc Trung Nam</h1>
    </div>

    <div class="input-section">
        <div class="select-group">
            <label for="region">Chọn miền:</label>
            <select id="region">
                <option value="mien-bac">Xổ Số Miền Bắc</option>
                <option value="mien-trung">Xổ Số Miền Trung</option>
                <option value="mien-nam">Xổ Số Miền Nam</option>
                <option value="lotto-ku">Lotto Ku</option>
            </select>
        </div>

        <div class="select-group">
            <label for="province">Chọn đài xổ số:</label>
            <select id="province"></select>
        </div>

        <button class="btn" id="startSimulation">Phân Tích & Dự Đoán</button>
        <button class="btn" id="refreshButton" style="background: linear-gradient(45deg, #00ff88, #0088ff);">Làm Mới</button>
        <button class="btn" id="resetSpin" style="background: linear-gradient(45deg, #ff0055, #ff8800);">Reset Dữ Liệu</button>
    </div>

    <div class="loading">
        <span class="loading-dots">Đang phân tích dữ liệu</span>
    </div>

    <div id="result"></div>
</div>

<div class="notification" id="notification"></div>

<script>
// Định nghĩa các tỉnh/thành cho từng miền
const provinces = {
    "mien-bac": [
        "Hà Nội", "Quảng Ninh", "Bắc Ninh", "Hải Phòng", 
        "Nam Định", "Thái Bình", "Hà Nam", "Ninh Bình"
    ],
    "mien-trung": [
        "Đà Nẵng", "Quảng Nam", "Quảng Ngãi", "Bình Định", 
        "Phú Yên", "Khánh Hòa", "Ninh Thuận", "Bình Thuận",
        "Kon Tum", "Gia Lai", "Đắk Lắk", "Đắk Nông",
        "Quảng Bình", "Quảng Trị", "Thừa Thiên Huế"
    ],
    "mien-nam": [
        "TP.HCM", "Long An", "Bến Tre", "Vũng Tàu",
        "Bạc Liêu", "Đồng Tháp", "Cần Thơ", "Sóc Trăng",
        "Tây Ninh", "An Giang", "Bình Thuận", "Vĩnh Long",
        "Bình Dương", "Trà Vinh", "Đồng Nai", "Cà Mau",
        "Kiên Giang", "Tiền Giang"
    ],
    "lotto-ku": ["Lotto Win"]
};

// Khởi tạo class quản lý dữ liệu
class LotteryManager {
    constructor() {
        this.storage = localStorage;
        this.historyKey = 'lottery_history';
    }

    saveResult(region, province, numbers) {
        let history = this.getHistory();
        history.push({
            region,
            province,
            numbers,
            timestamp: new Date().toISOString()
        });
        if (history.length > 100) history.shift();
        this.storage.setItem(this.historyKey, JSON.stringify(history));
    }

    getHistory() {
        const history = this.storage.getItem(this.historyKey);
        return history ? JSON.parse(history) : [];
    }

    clearHistory() {
        this.storage.removeItem(this.historyKey);
    }

    generateNumbers(type, count) {
        const numbers = new Set();
        const history = this.getHistory();
        const recentNumbers = this.getRecentNumbers(history);
        
        while (numbers.size < count) {
            let num;
            if (Math.random() < 0.4 && recentNumbers.hot.length > 0) {
                // 40% chance to pick a hot number
                num = recentNumbers.hot[Math.floor(Math.random() * recentNumbers.hot.length)];
            } else if (Math.random() < 0.3 && recentNumbers.cold.length > 0) {
                // 30% chance to pick a cold number
                num = recentNumbers.cold[Math.floor(Math.random() * recentNumbers.cold.length)];
            } else {
                // 30% chance for random number
                num = this.getRandomNumber(type);
            }
            numbers.add(num.toString().padStart(2, '0'));
        }
        return Array.from(numbers).sort((a, b) => parseInt(a) - parseInt(b));
    }

    getRandomNumber(type) {
        switch(type) {
            case 'mega645': return Math.floor(Math.random() * 45) + 1;
            case 'power655': return Math.floor(Math.random() * 55) + 1;
            default: return Math.floor(Math.random() * 100);
        }
    }

    getRecentNumbers(history) {
        const numberFrequency = {};
        history.forEach(record => {
            Object.values(record.numbers).flat().forEach(num => {
                numberFrequency[num] = (numberFrequency[num] || 0) + 1;
            });
        });

        const entries = Object.entries(numberFrequency);
        entries.sort((a, b) => b[1] - a[1]);

        return {
            hot: entries.slice(0, 10).map(entry => entry[0]),
            cold: entries.slice(-10).map(entry => entry[0])
        };
    }
}

// Khởi tạo
const lotteryManager = new LotteryManager();

// Cập nhật danh sách tỉnh/thành
function updateProvinceDropdown(region) {
    const provinceSelect = document.getElementById('province');
    provinceSelect.innerHTML = '';
    
    provinces[region].forEach(province => {
        const option = document.createElement('option');
        option.value = province;
        option.textContent = province;
        provinceSelect.appendChild(option);
    });
}

// Hiển thị kết quả
function displayResults(region, province) {
    const resultDiv = document.getElementById('result');
    
    // Generate different number sets
    const ghep4D = lotteryManager.generateNumbers('normal', 7);
    const ghep3D = lotteryManager.generateNumbers('normal', 7);
    const dan2D = lotteryManager.generateNumbers('normal', 64);
    const mega645 = lotteryManager.generateNumbers('mega645', 6);
    const power655 = lotteryManager.generateNumbers('power655', 6);

    const numbers = {
        ghep4D,
        ghep3D,
        dan2D,
        mega645,
        power655
    };

    // Save results
    lotteryManager.saveResult(region, province, numbers);

    // Display results
    resultDiv.innerHTML = `
        <div class="result-section">
            <h2>Kết quả Xổ Số: ${province}</h2>
            
            <div class="number-set">
                <h3>Ghép 4D:</h3>
                <div class="number-grid">
                    ${ghep4D.map(num => `
                        <div class="number-cell">${num}</div>
                    `).join('')}
                </div>
                <button class="copy-btn" onclick="copyText('${ghep4D.join(',')}')">Copy</button>
            </div>

            <div class="number-set">
                <h3>Ghép 3D:</h3>
                <div class="number-grid">
                    ${ghep3D.map(num => `
                        <div class="number-cell">${num}</div>
                    `).join('')}
                </div>
                <button class="copy-btn" onclick="copyText('${ghep3D.join(',')}')">Copy</button>
            </div>

            <div class="number-set">
                <h3>Dàn 2D - 64 Số:</h3>
                <div class="number-grid">
                    ${dan2D.map(num => `
                        <div class="number-cell">${num}</div>
                    `).join('')}
                </div>
                <button class="copy-btn" onclick="copyText('${dan2D.join(',')}')">Copy</button>
            </div>

            <div class="number-set">
                <h3>Mega 6/45:</h3>
                <div class="number-grid">
                    ${mega645.map(num => `
                        <div class="number-cell">${num}</div>
                    `).join('')}
                </div>
                <button class="copy-btn" onclick="copyText('${mega645.join(',')}')">Copy</button>
            </div>

            <div class="number-set">
                <h3>Power 6/55:</h3>
                <div class="number-grid">
                    ${power655.map(num => `
                        <div class="number-cell">${num}</div>
                    `).join('')}
                </div>
                <button class="copy-btn" onclick="copyText('${power655.join(',')}')">Copy</button>
            </div>
        </div>
    `;
}

// Xử lý sự kiện copy
function copyText(text) {
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Đã sao chép!');
    }).catch(err => {
        showNotification('Không thể sao chép: ' + err);
    });
}

// Hiển thị thông báo
function showNotification(message) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 2000);
}

// Khởi tạo sự kiện
document.getElementById('region').addEventListener('change', (e) => {
    updateProvinceDropdown(e.target.value);
});

document.getElementById('startSimulation').addEventListener('click', () => {
    const region = document.getElementById('region').value;
    const province = document.getElementById('province').value;
    
    document.querySelector('.loading').style.display = 'block';
    document.getElementById('result').innerHTML = '';

    setTimeout(() => {
        displayResults(region, province);
        document.querySelector('.loading').style.display = 'none';
    }, 1500);
});

document.getElementById('refreshButton').addEventListener('click', () => {
    location.reload();
});

document.getElementById('resetSpin').addEventListener('click', () => {
    lotteryManager.clearHistory();
    showNotification('Đã reset toàn bộ dữ liệu!');
});

// Khởi tạo ban đầu
updateProvinceDropdown(document.getElementById('region').value);
</script>
</body>
</html>
