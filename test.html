<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xử lý Dữ liệu XSMB</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #000;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        .section-title {
            font-size: 1.5em;
            margin-top: 20px;
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <h1>Phân bổ Dữ liệu XSMB - Ngày Mới</h1>

    <div class="section-title">Giải thưởng:</div>
    <table id="prizes-table">
        <tr>
            <th>Giải</th>
            <th>Giá trị</th>
        </tr>
    </table>

    <div class="section-title">Đầu - Đuôi Lô Tô:</div>
    <table id="head-tail-table">
        <tr>
            <th>Đầu</th>
            <th>Đuôi</th>
        </tr>
    </table>

    <script>
        async function fetchData() {
            const url = 'https://raw.githubusercontent.com/LEDO-DEV-SITE-OSCAR/API_XSMB/refs/heads/main/data/xsmb.csv';
            const response = await fetch(url);
            const data = await response.text();
            parseData(data);
        }

        function parseData(data) {
            const rows = data.split('\n').map(row => row.split(','));

            // Lọc lấy ngày hôm nay
            const today = new Date().toLocaleDateString('vi-VN'); // Lấy ngày hiện tại
            const todayData = rows.find(row => row[0] === today); // Tìm dữ liệu ngày hôm nay

            if (todayData) {
                // Giải thưởng
                const prizes = {
                    'Đặc biệt': todayData[1],
                    'Giải nhất': todayData[2],
                    'Giải nhì': todayData[3],
                    'Giải ba': todayData[4],
                    'Giải tư': todayData[5],
                    'Giải năm': todayData[6],
                    'Giải sáu': todayData[7],
                    'Giải bảy': todayData[8]
                };

                // Hiển thị giải thưởng
                const prizeTable = document.getElementById('prizes-table');
                for (const [prize, value] of Object.entries(prizes)) {
                    const row = document.createElement('tr');
                    const cell1 = document.createElement('td');
                    cell1.textContent = prize;
                    const cell2 = document.createElement('td');
                    cell2.textContent = value;
                    row.appendChild(cell1);
                    row.appendChild(cell2);
                    prizeTable.appendChild(row);
                }

                // Đầu - Đuôi Lô Tô
                const lottoData = todayData.slice(9); // Lấy phần dữ liệu Lô Tô từ cột 10 trở đi
                const headTailData = {};

                // Phân bổ theo đầu và đuôi
                lottoData.forEach(number => {
                    const head = number.charAt(0); // Lấy đầu
                    const tail = number.charAt(number.length - 1); // Lấy đuôi

                    if (!headTailData[head]) headTailData[head] = [];
                    if (!headTailData[tail]) headTailData[tail] = [];

                    headTailData[head].push(tail);
                    headTailData[tail].push(head);
                });

                // Hiển thị Đầu - Đuôi Lô Tô
                const headTailTable = document.getElementById('head-tail-table');
                Object.entries(headTailData).forEach(([key, value]) => {
                    const row = document.createElement('tr');
                    const cell1 = document.createElement('td');
                    cell1.textContent = key;
                    const cell2 = document.createElement('td');
                    cell2.textContent = value.join(', ');
                    row.appendChild(cell1);
                    row.appendChild(cell2);
                    headTailTable.appendChild(row);
                });
            } else {
                alert('Không có dữ liệu cho ngày hôm nay.');
            }
        }

        // Gọi hàm khi tải trang
        fetchData();
    </script>

</body>
</html>
